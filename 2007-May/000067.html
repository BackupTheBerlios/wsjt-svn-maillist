<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [WSJT-SVN] r382 - trunk
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/wsjt-svn/2007-May/index.html" >
   <LINK REL="made" HREF="mailto:wsjt-svn%40lists.berlios.de?Subject=Re%3A%20%5BWSJT-SVN%5D%20r382%20-%20trunk&In-Reply-To=%3C200705031729.l43HTcqu000825%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000066.html">
   <LINK REL="Next"  HREF="000068.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[WSJT-SVN] r382 - trunk</H1>
    <B>va3db at BerliOS</B> 
    <A HREF="mailto:wsjt-svn%40lists.berlios.de?Subject=Re%3A%20%5BWSJT-SVN%5D%20r382%20-%20trunk&In-Reply-To=%3C200705031729.l43HTcqu000825%40sheep.berlios.de%3E"
       TITLE="[WSJT-SVN] r382 - trunk">va3db at mail.berlios.de
       </A><BR>
    <I>Thu May  3 19:29:38 CEST 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000066.html">[WSJT-SVN] r381 - trunk
</A></li>
        <LI>Next message: <A HREF="000068.html">[WSJT-SVN] r383 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67">[ date ]</a>
              <a href="thread.html#67">[ thread ]</a>
              <a href="subject.html#67">[ subject ]</a>
              <a href="author.html#67">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: va3db
Date: 2007-05-03 19:29:37 +0200 (Thu, 03 May 2007)
New Revision: 382

Modified:
   trunk/Makefile.in
   trunk/configure
   trunk/configure.ac
Log:
- Re-enable use of our snapshot of portaudio-v19 if --enable-portable is used
  but no --with-portaudio-include-dir and --with-portaudio-lib-dir are given.



Modified: trunk/Makefile.in
===================================================================
--- trunk/Makefile.in	2007-05-03 14:47:41 UTC (rev 381)
+++ trunk/Makefile.in	2007-05-03 17:29:37 UTC (rev 382)
@@ -97,11 +97,12 @@
 JT65code: $(OBJS1)
 	$(FC) -o JT65code $(OBJS1)
 
+portaudio:
 portaudio-v19/lib/.libs/libportaudio.a:
 	(cd portaudio-v19;./configure --with-jack=no)
 	(cd portaudio-v19;${MAKE})
 
-wsjt6:	Audio.so #wsjt.spec
+wsjt6:	@LOCAL_PORTAUDIO@ Audio.so
 #	${PYTHON} c:\python23\installer\Build.py wsjt.spec
 #	${RM} wsjt6
 

Modified: trunk/configure
===================================================================
--- trunk/configure	2007-05-03 14:47:41 UTC (rev 381)
+++ trunk/configure	2007-05-03 17:29:37 UTC (rev 382)
@@ -2,7 +2,7 @@
 # Guess values for system-dependent variables and create Makefiles.
 # Generated by GNU Autoconf 2.59 for wsjt 5.9.6.
 #
-# $Id: configure.ac 359 2007-02-23 17:00:24Z va3db $
+# $Id: configure.ac 362 2007-03-02 20:05:24Z va3db $
 #
 # Copyright (C) 2003 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
@@ -311,7 +311,7 @@
 # include &lt;unistd.h&gt;
 #endif&quot;
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT F77 FFLAGS ac_ct_F77 CPP EGREP SET_MAKE INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA RM CP MV LN SED AR LD TEST PYTHON F2PY G95 GFORTRAN OS CLOBBER FC_LIB_PATH FC AUDIO LIBOBJS LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT F77 FFLAGS ac_ct_F77 CPP EGREP SET_MAKE INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA RM CP MV LN SED AR LD TEST PYTHON F2PY G95 GFORTRAN OS CLOBBER FC_LIB_PATH FC AUDIO LOCAL_PORTAUDIO LIBOBJS LTLIBOBJS'
 ac_subst_files=''
 
 # Initialize some variables set by options.
@@ -984,7 +984,7 @@
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 
-$Id: configure.ac 359 2007-02-23 17:00:24Z va3db $
+$Id: configure.ac 362 2007-03-02 20:05:24Z va3db $
 _ACEOF
   exit 0
 fi
@@ -4769,6 +4769,7 @@
 
 HAS_PORTAUDIO_H=0
 HAS_PORTAUDIO_LIB=0
+HAS_PORTAUDIO=0
 
 echo &quot;$as_me:$LINENO: checking whether string.h and strings.h may both be included&quot; &gt;&amp;5
 echo $ECHO_N &quot;checking whether string.h and strings.h may both be included... $ECHO_C&quot; &gt;&amp;6
@@ -6873,7 +6874,7 @@
 
 if test &quot;$alsa&quot; != yes -a &quot;$oss&quot; != yes -a \
 	&quot;$portaudio&quot; != yes; then
-        if test $HAS_PORTAUDIO_H -eq 1; then
+        if test $HAS_PORTAUDIO -eq 1; then
 		portaudio=yes;
 	elif test $HAS_ASOUNDLIB_H -eq 1; then
 		alsa=yes;
@@ -6882,9 +6883,50 @@
 	fi
 fi
 
+
 if test &quot;$alsa&quot; = yes; then
+	if test $HAS_ASOUNDLIB_H -eq 0; then
+		{ { echo &quot;$as_me:$LINENO: error: You need asoundlib.h to use --enable-alsa&quot; &gt;&amp;5
+echo &quot;$as_me: error: You need asoundlib.h to use --enable-alsa&quot; &gt;&amp;2;}
+   { (exit 1); exit 1; }; }
+	fi
+fi
 
+if test &quot;$oss&quot; = yes; then
+	if test $HAS_SOUNDCARD_H -eq 0; then
+		{ { echo &quot;$as_me:$LINENO: error: You need soundcard.h to use --enable-oss&quot; &gt;&amp;5
+echo &quot;$as_me: error: You need soundcard.h to use --enable-oss&quot; &gt;&amp;2;}
+   { (exit 1); exit 1; }; }
+	fi
+fi
+
+if test &quot;$portaudio&quot; = yes; then
+	if test $HAS_PORTAUDIO -eq 0; then
+		echo &quot;&quot;
+		echo &quot;Using portaudio provided&quot;
+		echo &quot;&quot;
+		portaudio_include_dir=&quot;portaudio-v19/include&quot;
+		LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate portaudio-v19/lib/.libs/libportaudio.a&quot;
+		LOCAL_PORTAUDIO=&quot;portaudio&quot;
+	else
+		LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
+		LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate -lportaudio&quot;
+		LOCAL_PORTAUDIO=&quot;&quot;
+	fi
+	AUDIO=&quot;a2d.f90 jtaudio.c resample.c start_portaudio.c&quot;
+
+
 cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
+#define USE_PORTAUDIO 1
+_ACEOF
+
+	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
+fi
+
+
+if test &quot;$alsa&quot; = yes; then
+
+cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
 #define USE_ALSA 1
 _ACEOF
 
@@ -6903,20 +6945,8 @@
 
 fi
 
-if test &quot;$portaudio&quot; = yes; then
 
-cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
-#define USE_PORTAUDIO 1
-_ACEOF
 
-	AUDIO=&quot;a2d.f90 jtaudio.c resample.c start_portaudio.c&quot;
-
-	LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
-	LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate -lportaudio&quot;
-	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
-fi
-
-
 if test $HAS_ASOUNDLIB_H -eq 1; then
 	cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
 #define HAS_ASOUNDLIB_H 1
@@ -6953,40 +6983,6 @@
 fi
 
 
-if test &quot;$alsa&quot; = yes; then
-	if test $HAS_ASOUNDLIB_H -eq 0; then
-		{ { echo &quot;$as_me:$LINENO: error: You need asoundlib.h to use --enable-alsa&quot; &gt;&amp;5
-echo &quot;$as_me: error: You need asoundlib.h to use --enable-alsa&quot; &gt;&amp;2;}
-   { (exit 1); exit 1; }; }
-	fi
-fi
-
-if test &quot;$oss&quot; = yes; then
-	if test $HAS_SOUNDCARD_H -eq 0; then
-		{ { echo &quot;$as_me:$LINENO: error: You need soundcard.h to use --enable-oss&quot; &gt;&amp;5
-echo &quot;$as_me: error: You need soundcard.h to use --enable-oss&quot; &gt;&amp;2;}
-   { (exit 1); exit 1; }; }
-	fi
-fi
-
-if test &quot;$portaudio&quot; = yes; then
-	if test $HAS_PORTAUDIO_H -eq 0; then
-		{ { echo &quot;$as_me:$LINENO: error: You need portaudio.h to use --enable-portaudio&quot; &gt;&amp;5
-echo &quot;$as_me: error: You need portaudio.h to use --enable-portaudio&quot; &gt;&amp;2;}
-   { (exit 1); exit 1; }; }
-	fi
-	if test $HAS_PORTAUDIO_LIB -eq 0; then
-		{ { echo &quot;$as_me:$LINENO: error: You need libportaudio to use --enable-portaudio&quot; &gt;&amp;5
-echo &quot;$as_me: error: You need libportaudio to use --enable-portaudio&quot; &gt;&amp;2;}
-   { (exit 1); exit 1; }; }
-	fi
-	if test $HAS_SAMPLERATE_H -eq 0; then
-		{ { echo &quot;$as_me:$LINENO: error: You need samplerate.h to use --enable-portaudio&quot; &gt;&amp;5
-echo &quot;$as_me: error: You need samplerate.h to use --enable-portaudio&quot; &gt;&amp;2;}
-   { (exit 1); exit 1; }; }
-	fi
-fi
-
 if test &quot;$F2PY&quot; = &quot;&quot;; then
 	{ { echo &quot;$as_me:$LINENO: error: You are missing f2py&quot; &gt;&amp;5
 echo &quot;$as_me: error: You are missing f2py&quot; &gt;&amp;2;}
@@ -7000,7 +6996,9 @@
 LIBS=&quot;${LIBS}&quot;
 
 
+LOCAL_PORTAUDIO=&quot;${LOCAL_PORTAUDIO}&quot;
 
+
 cat &gt;confcache &lt;&lt;\_ACEOF
 # This file is a shell script that caches the results of configure
 # tests run on this system so they can be shared between configure
@@ -7669,6 +7667,7 @@
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at FC_LIB_PATH</A>@,$FC_LIB_PATH,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at FC</A>@,$FC,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at AUDIO</A>@,$AUDIO,;t t
<A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">+s, at LOCAL_PORTAUDIO</A>@,$LOCAL_PORTAUDIO,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at LIBOBJS</A>@,$LIBOBJS,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at LTLIBOBJS</A>@,$LTLIBOBJS,;t t
 CEOF

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2007-05-03 14:47:41 UTC (rev 381)
+++ trunk/configure.ac	2007-05-03 17:29:37 UTC (rev 382)
@@ -114,6 +114,7 @@
 AC_CHECK_HEADER([samplerate.h], [HAS_SAMPLERATE_H=1], [HAS_SAMPLERATE_H=0])
 HAS_PORTAUDIO_H=0
 HAS_PORTAUDIO_LIB=0
+HAS_PORTAUDIO=0
 
 dnl See whether we can include both string.h and strings.h.
 AC_CACHE_CHECK([whether string.h and strings.h may both be included],
@@ -210,7 +211,6 @@
 	Makefile		
 )
 
-dnl Do I dare assume a default for these? -db
 dnl =========================================
 portaudio_lib_dir=&quot;&quot;
 portaudio_include_dir=&quot;&quot;
@@ -309,7 +309,7 @@
 
 if test &quot;$alsa&quot; != yes -a &quot;$oss&quot; != yes -a \
 	&quot;$portaudio&quot; != yes; then
-        if test $HAS_PORTAUDIO_H -eq 1; then
+        if test $HAS_PORTAUDIO -eq 1; then
 		[portaudio=yes];
 	elif test $HAS_ASOUNDLIB_H -eq 1; then
 		[alsa=yes];
@@ -318,7 +318,43 @@
 	fi
 fi
 
+dnl =============
+dnl sanity tests.
+
 if test &quot;$alsa&quot; = yes; then
+	if test $HAS_ASOUNDLIB_H -eq 0; then
+		AC_MSG_ERROR([You need asoundlib.h to use --enable-alsa])
+	fi
+fi
+
+if test &quot;$oss&quot; = yes; then
+	if test $HAS_SOUNDCARD_H -eq 0; then
+		AC_MSG_ERROR([You need soundcard.h to use --enable-oss])
+	fi
+fi
+
+if test &quot;$portaudio&quot; = yes; then
+	if test $HAS_PORTAUDIO -eq 0; then
+		echo &quot;&quot;
+		echo &quot;Using portaudio provided&quot;
+		echo &quot;&quot;
+		portaudio_include_dir=&quot;portaudio-v19/include&quot;
+		LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate portaudio-v19/lib/.libs/libportaudio.a&quot;
+		LOCAL_PORTAUDIO=&quot;portaudio&quot;
+	else
+		LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
+		LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate -lportaudio&quot;
+		LOCAL_PORTAUDIO=&quot;&quot;
+	fi
+	AC_SUBST(AUDIO, &quot;a2d.f90 jtaudio.c resample.c start_portaudio.c&quot;)
+	AC_DEFINE(USE_PORTAUDIO, 1, [Define if you want PORTAUDIO used.])
+	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
+fi
+
+dnl =====================
+dnl final audio selection
+
+if test &quot;$alsa&quot; = yes; then
 	AC_DEFINE(USE_ALSA, 1, [Define if you want ALSA used.])
 	AC_SUBST(AUDIO, &quot;start_alsa.c&quot;)
 	LIBS=&quot;${LIBS} -lasound&quot;
@@ -329,13 +365,6 @@
 	AC_SUBST(AUDIO, &quot;start_oss.c&quot;)
 fi
 
-if test &quot;$portaudio&quot; = yes; then
-	AC_DEFINE(USE_PORTAUDIO, 1, [Define if you want PORTAUDIO used.])
-	AC_SUBST(AUDIO, &quot;a2d.f90 jtaudio.c resample.c start_portaudio.c&quot;)
-	LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
-	LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate -lportaudio&quot;
-	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
-fi
 
 dnl set conf flags
 dnl ==============
@@ -360,33 +389,7 @@
         AC_DEFINE(HAS_SAMPLERATE_H, 1, )
 fi
 
-dnl sanity tests.
-dnl =============
 
-if test &quot;$alsa&quot; = yes; then
-	if test $HAS_ASOUNDLIB_H -eq 0; then
-		AC_MSG_ERROR([You need asoundlib.h to use --enable-alsa])
-	fi
-fi
-
-if test &quot;$oss&quot; = yes; then
-	if test $HAS_SOUNDCARD_H -eq 0; then
-		AC_MSG_ERROR([You need soundcard.h to use --enable-oss])
-	fi
-fi
-
-if test &quot;$portaudio&quot; = yes; then
-	if test $HAS_PORTAUDIO_H -eq 0; then
-		AC_MSG_ERROR([You need portaudio.h to use --enable-portaudio])
-	fi
-	if test $HAS_PORTAUDIO_LIB -eq 0; then
-		AC_MSG_ERROR([You need libportaudio to use --enable-portaudio])
-	fi
-	if test $HAS_SAMPLERATE_H -eq 0; then
-		AC_MSG_ERROR([You need samplerate.h to use --enable-portaudio])
-	fi
-fi
-
 if test &quot;$F2PY&quot; = &quot;&quot;; then
 	AC_MSG_ERROR([You are missing f2py])
 fi
@@ -396,6 +399,7 @@
 AC_SUBST(LDFLAGS, &quot;${LDFLAGS}&quot;)
 AC_SUBST(LIBS, &quot;${LIBS}&quot;)
 AC_SUBST(CFLAGS)
+AC_SUBST(LOCAL_PORTAUDIO,&quot;${LOCAL_PORTAUDIO}&quot;)
 
 AC_OUTPUT
 dnl AC_CONFIG_FILES(Makefile)


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000066.html">[WSJT-SVN] r381 - trunk
</A></li>
	<LI>Next message: <A HREF="000068.html">[WSJT-SVN] r383 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#67">[ date ]</a>
              <a href="thread.html#67">[ thread ]</a>
              <a href="subject.html#67">[ subject ]</a>
              <a href="author.html#67">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/wsjt-svn">More information about the wsjt-svn
mailing list</a><br>
</body></html>
