<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [WSJT-SVN] r362 - trunk
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/wsjt-svn/2007-March/index.html" >
   <LINK REL="made" HREF="mailto:wsjt-svn%40lists.berlios.de?Subject=Re%3A%20%5BWSJT-SVN%5D%20r362%20-%20trunk&In-Reply-To=%3C200703022005.l22K5OWh012277%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000046.html">
   <LINK REL="Next"  HREF="000048.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[WSJT-SVN] r362 - trunk</H1>
    <B>va3db at BerliOS</B> 
    <A HREF="mailto:wsjt-svn%40lists.berlios.de?Subject=Re%3A%20%5BWSJT-SVN%5D%20r362%20-%20trunk&In-Reply-To=%3C200703022005.l22K5OWh012277%40sheep.berlios.de%3E"
       TITLE="[WSJT-SVN] r362 - trunk">va3db at mail.berlios.de
       </A><BR>
    <I>Fri Mar  2 21:05:24 CET 2007</I>
    <P><UL>
        <LI>Previous message: <A HREF="000046.html">[WSJT-SVN] r361 - trunk
</A></li>
        <LI>Next message: <A HREF="000048.html">[WSJT-SVN] r363 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47">[ date ]</a>
              <a href="thread.html#47">[ thread ]</a>
              <a href="subject.html#47">[ subject ]</a>
              <a href="author.html#47">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: va3db
Date: 2007-03-02 21:05:24 +0100 (Fri, 02 Mar 2007)
New Revision: 362

Modified:
   trunk/Makefile.in
   trunk/configure
   trunk/configure.ac
Log:
- unhook wsjt build from included portaudio
  add two new configure arguments --with-portaudio-include-dir and
  --with-portaudio-lib-dir to point to location of portaudio
  Note that portaudio v19 is still in transition and API differs from stock 
  in many systems, notably number of arguments in Pa_OpenStream



Modified: trunk/Makefile.in
===================================================================
--- trunk/Makefile.in	2007-03-02 20:02:53 UTC (rev 361)
+++ trunk/Makefile.in	2007-03-02 20:05:24 UTC (rev 362)
@@ -88,8 +88,6 @@
 # and mostly sorted
 # --db
 #
-#  @NEEDPORTAUDIO@ will be filled in with libportaudio.a if portaudio is used
-#
 SRCS3C	= ptt_unix.c igray.c wrapkarn.c cutil.c
 OBJS3C  = ${SRCS3C:.c=.o}
 AUDIOSRCS = @AUDIO@
@@ -103,7 +101,7 @@
 	(cd portaudio-v19;./configure --with-jack=no)
 	(cd portaudio-v19;${MAKE})
 
-wsjt6:	@NEEDPORTAUDIO@ Audio.so #wsjt.spec
+wsjt6:	Audio.so #wsjt.spec
 #	${PYTHON} c:\python23\installer\Build.py wsjt.spec
 #	${RM} wsjt6
 
@@ -133,7 +131,7 @@
 .PHONY : clean
 clean:
 	${RM} -f *.o *.pyc *.so *~ JT65code wsjt6
-	(cd portaudio-v19;${MAKE} clean)
+
 distclean: clean
 	${RM} -f config.log config.status Makefile
-	(cd portaudio-v19;${MAKE} distclean)
+

Modified: trunk/configure
===================================================================
--- trunk/configure	2007-03-02 20:02:53 UTC (rev 361)
+++ trunk/configure	2007-03-02 20:05:24 UTC (rev 362)
@@ -2,7 +2,7 @@
 # Guess values for system-dependent variables and create Makefiles.
 # Generated by GNU Autoconf 2.59 for wsjt 5.9.6.
 #
-# $Id: configure.ac 312 2006-09-23 08:37:07Z va3db $
+# $Id: configure.ac 359 2007-02-23 17:00:24Z va3db $
 #
 # Copyright (C) 2003 Free Software Foundation, Inc.
 # This configure script is free software; the Free Software Foundation
@@ -311,7 +311,7 @@
 # include &lt;unistd.h&gt;
 #endif&quot;
 
-ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT F77 FFLAGS ac_ct_F77 CPP EGREP SET_MAKE INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA RM CP MV LN SED AR LD TEST PYTHON F2PY G95 GFORTRAN OS CLOBBER FC_LIB_PATH FC AUDIO NEEDPORTAUDIO LIBOBJS LTLIBOBJS'
+ac_subst_vars='SHELL PATH_SEPARATOR PACKAGE_NAME PACKAGE_TARNAME PACKAGE_VERSION PACKAGE_STRING PACKAGE_BUGREPORT exec_prefix prefix program_transform_name bindir sbindir libexecdir datadir sysconfdir sharedstatedir localstatedir libdir includedir oldincludedir infodir mandir build_alias host_alias target_alias DEFS ECHO_C ECHO_N ECHO_T LIBS CC CFLAGS LDFLAGS CPPFLAGS ac_ct_CC EXEEXT OBJEXT F77 FFLAGS ac_ct_F77 CPP EGREP SET_MAKE INSTALL_PROGRAM INSTALL_SCRIPT INSTALL_DATA RM CP MV LN SED AR LD TEST PYTHON F2PY G95 GFORTRAN OS CLOBBER FC_LIB_PATH FC AUDIO LIBOBJS LTLIBOBJS'
 ac_subst_files=''
 
 # Initialize some variables set by options.
@@ -860,6 +860,14 @@
   --enable-g95            Use G95 compiler if available.
   --enable-gfortran       Use gfortran compiler if available.
 
+Optional Packages:
+  --with-PACKAGE[=ARG]    use PACKAGE [ARG=yes]
+  --without-PACKAGE       do not use PACKAGE (same as --with-PACKAGE=no)
+  --with-portaudio-include-dir=&lt;path&gt;
+                          path to portaudio include files
+  --with-portaudio-lib-dir=&lt;path&gt;
+                          path to portaudio lib files
+
 Some influential environment variables:
   CC          C compiler command
   CFLAGS      C compiler flags
@@ -976,7 +984,7 @@
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 
-$Id: configure.ac 312 2006-09-23 08:37:07Z va3db $
+$Id: configure.ac 359 2007-02-23 17:00:24Z va3db $
 _ACEOF
   exit 0
 fi
@@ -2353,7 +2361,7 @@
 
 
 # Provide some information about the compiler.
-echo &quot;$as_me:2356:&quot; \
+echo &quot;$as_me:2364:&quot; \
      &quot;checking for Fortran 77 compiler version&quot; &gt;&amp;5
 ac_compiler=`set X $ac_compile; echo $2`
 { (eval echo &quot;$as_me:$LINENO: \&quot;$ac_compiler --version &lt;/dev/null &gt;&amp;5\&quot;&quot;) &gt;&amp;5
@@ -2500,7 +2508,7 @@
 
 CFLAGS=&quot;$OLD_CFLAGS&quot;
 
-CPPFLAGS=&quot;-Iportaudio-v19/include -I/usr/local/include -I/usr/include/alsa -I/usr/local/include/alsa ${CPPFLAGS}&quot;
+CPPFLAGS=&quot;-I/usr/local/include -I/usr/include/alsa -I/usr/local/include/alsa ${CPPFLAGS}&quot;
 LDFLAGS=&quot;-L/usr/local/lib ${LDFLAGS}&quot;
 LIBS=&quot; -lpthread ${LIBS}&quot;
 
@@ -4615,13 +4623,6 @@
 fi
 
 
-if test -e &quot;portaudio-v19/include/portaudio.h&quot; ; then
-	echo &quot;Checking for portaudio...yes&quot;
-	HAS_PORTAUDIO_H=1
-else
-	echo &quot;Checking for portaudio...no&quot;
-	HAS_PORTAUDIO_H=0
-fi
 if test &quot;${ac_cv_header_samplerate_h+set}&quot; = set; then
   echo &quot;$as_me:$LINENO: checking for samplerate.h&quot; &gt;&amp;5
 echo $ECHO_N &quot;checking for samplerate.h... $ECHO_C&quot; &gt;&amp;6
@@ -4766,6 +4767,8 @@
 fi
 
 
+HAS_PORTAUDIO_H=0
+HAS_PORTAUDIO_LIB=0
 
 echo &quot;$as_me:$LINENO: checking whether string.h and strings.h may both be included&quot; &gt;&amp;5
 echo $ECHO_N &quot;checking whether string.h and strings.h may both be included... $ECHO_C&quot; &gt;&amp;6
@@ -6751,7 +6754,33 @@
           ac_config_files=&quot;$ac_config_files Makefile&quot;
 
 
+portaudio_lib_dir=&quot;&quot;
+portaudio_include_dir=&quot;&quot;
 
+
+# Check whether --with-portaudio-include-dir or --without-portaudio-include-dir was given.
+if test &quot;${with_portaudio_include_dir+set}&quot; = set; then
+  withval=&quot;$with_portaudio_include_dir&quot;
+  portaudio_include_dir=$with_portaudio_include_dir
+fi;
+
+
+# Check whether --with-portaudio-lib-dir or --without-portaudio-lib-dir was given.
+if test &quot;${with_portaudio_lib_dir+set}&quot; = set; then
+  withval=&quot;$with_portaudio_lib_dir&quot;
+  portaudio_lib_dir=$with_portaudio_lib_dir
+fi;
+
+if test -e ${portaudio_lib_dir}/libportaudio.so;then
+	HAS_PORTAUDIO_LIB=1
+fi
+if test -e ${portaudio_include_dir}/portaudio.h; then
+	HAS_PORTAUDIO_H=1
+fi
+if test $HAS_PORTAUDIO_H -eq 1 -a $HAS_PORTAUDIO_LIB -eq 1; then
+	HAS_PORTAUDIO=1
+fi
+
 # Check whether --enable-alsa or --disable-alsa was given.
 if test &quot;${enable_alsa+set}&quot; = set; then
   enableval=&quot;$enable_alsa&quot;
@@ -6882,13 +6911,9 @@
 
 	AUDIO=&quot;a2d.f90 jtaudio.c resample.c start_portaudio.c&quot;
 
-	NEEDPORTAUDIO=&quot;portaudio-v19/lib/.libs/libportaudio.a&quot;
-
-	LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate ./portaudio-v19/lib/.libs/libportaudio.a&quot;
-	LIBS=&quot;${LIBS} ${ASOUNDLIBS}&quot;
-else
-	NEEDPORTAUDIO=&quot;&quot;
-
+	LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
+	LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate -lportaudio&quot;
+	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
 fi
 
 
@@ -6950,6 +6975,11 @@
 echo &quot;$as_me: error: You need portaudio.h to use --enable-portaudio&quot; &gt;&amp;2;}
    { (exit 1); exit 1; }; }
 	fi
+	if test $HAS_PORTAUDIO_LIB -eq 0; then
+		{ { echo &quot;$as_me:$LINENO: error: You need libportaudio to use --enable-portaudio&quot; &gt;&amp;5
+echo &quot;$as_me: error: You need libportaudio to use --enable-portaudio&quot; &gt;&amp;2;}
+   { (exit 1); exit 1; }; }
+	fi
 	if test $HAS_SAMPLERATE_H -eq 0; then
 		{ { echo &quot;$as_me:$LINENO: error: You need samplerate.h to use --enable-portaudio&quot; &gt;&amp;5
 echo &quot;$as_me: error: You need samplerate.h to use --enable-portaudio&quot; &gt;&amp;2;}
@@ -7639,7 +7669,6 @@
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at FC_LIB_PATH</A>@,$FC_LIB_PATH,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at FC</A>@,$FC,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at AUDIO</A>@,$AUDIO,;t t
<A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">-s, at NEEDPORTAUDIO</A>@,$NEEDPORTAUDIO,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at LIBOBJS</A>@,$LIBOBJS,;t t
 <A HREF="https://lists.berlios.de/mailman/listinfo/wsjt-svn">s, at LTLIBOBJS</A>@,$LTLIBOBJS,;t t
 CEOF

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2007-03-02 20:02:53 UTC (rev 361)
+++ trunk/configure.ac	2007-03-02 20:05:24 UTC (rev 362)
@@ -20,7 +20,7 @@
 CFLAGS=&quot;$OLD_CFLAGS&quot;
 
 dnl Lets guess at some likely places for extra libs/includes XXX -db
-CPPFLAGS=&quot;-Iportaudio-v19/include -I/usr/local/include -I/usr/include/alsa -I/usr/local/include/alsa ${CPPFLAGS}&quot;
+CPPFLAGS=&quot;-I/usr/local/include -I/usr/include/alsa -I/usr/local/include/alsa ${CPPFLAGS}&quot;
 LDFLAGS=&quot;-L/usr/local/lib ${LDFLAGS}&quot;
 LIBS=&quot; -lpthread ${LIBS}&quot;
 
@@ -111,14 +111,9 @@
 AC_CHECK_HEADER([sys/soundcard.h], [HAS_SOUNDCARD_H=1], [HAS_SOUNDCARD_H=0])
 AC_CHECK_HEADER([alsa/asoundlib.h], [HAS_ASOUNDLIB_H=1], [HAS_ASOUNDLIB_H=0])
 AC_CHECK_HEADER([jack/jack.h], [HAS_JACK_H=1], [HAS_JACK_H=0])
-if test -e &quot;portaudio-v19/include/portaudio.h&quot; ; then
-	echo &quot;Checking for portaudio...yes&quot;
-	HAS_PORTAUDIO_H=1
-else
-	echo &quot;Checking for portaudio...no&quot;
-	HAS_PORTAUDIO_H=0
-fi
 AC_CHECK_HEADER([samplerate.h], [HAS_SAMPLERATE_H=1], [HAS_SAMPLERATE_H=0])
+HAS_PORTAUDIO_H=0
+HAS_PORTAUDIO_LIB=0
 
 dnl See whether we can include both string.h and strings.h.
 AC_CACHE_CHECK([whether string.h and strings.h may both be included],
@@ -215,6 +210,32 @@
 	Makefile		
 )
 
+dnl Do I dare assume a default for these? -db
+dnl =========================================
+portaudio_lib_dir=&quot;&quot;
+portaudio_include_dir=&quot;&quot;
+
+AC_ARG_WITH([portaudio-include-dir],
+AC_HELP_STRING([--with-portaudio-include-dir=&lt;path&gt;],
+    [path to portaudio include files]),
+    [portaudio_include_dir=$with_portaudio_include_dir])
+
+AC_ARG_WITH([portaudio-lib-dir],
+AC_HELP_STRING([--with-portaudio-lib-dir=&lt;path&gt;],
+    [path to portaudio lib files]),
+    [portaudio_lib_dir=$with_portaudio_lib_dir])
+
+dnl make sure portaudio dirs are valid
+dnl ==================================
+if test -e ${portaudio_lib_dir}/libportaudio.so;then
+	HAS_PORTAUDIO_LIB=1
+fi
+if test -e ${portaudio_include_dir}/portaudio.h; then
+	HAS_PORTAUDIO_H=1
+fi
+if test $HAS_PORTAUDIO_H -eq 1 -a $HAS_PORTAUDIO_LIB -eq 1; then
+	HAS_PORTAUDIO=1
+fi
 dnl alsa soundsupport
 dnl =================
 
@@ -311,14 +332,9 @@
 if test &quot;$portaudio&quot; = yes; then
 	AC_DEFINE(USE_PORTAUDIO, 1, [Define if you want PORTAUDIO used.])
 	AC_SUBST(AUDIO, &quot;a2d.f90 jtaudio.c resample.c start_portaudio.c&quot;)
-	AC_SUBST(NEEDPORTAUDIO, &quot;portaudio-v19/lib/.libs/libportaudio.a&quot;)
-dnl
-dnl	new portaudio-v19 on linux will be referencing alsa.
-dnl
-	LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate ./portaudio-v19/lib/.libs/libportaudio.a&quot;
-	LIBS=&quot;${LIBS} ${ASOUNDLIBS}&quot;
-else
-	AC_SUBST(NEEDPORTAUDIO, &quot;&quot;)
+	LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
+	LIBS=&quot;${LIBS} ${RTLIBS} -lsamplerate -lportaudio&quot;
+	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
 fi
 
 dnl set conf flags
@@ -363,6 +379,9 @@
 	if test $HAS_PORTAUDIO_H -eq 0; then
 		AC_MSG_ERROR([You need portaudio.h to use --enable-portaudio])
 	fi
+	if test $HAS_PORTAUDIO_LIB -eq 0; then
+		AC_MSG_ERROR([You need libportaudio to use --enable-portaudio])
+	fi
 	if test $HAS_SAMPLERATE_H -eq 0; then
 		AC_MSG_ERROR([You need samplerate.h to use --enable-portaudio])
 	fi


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000046.html">[WSJT-SVN] r361 - trunk
</A></li>
	<LI>Next message: <A HREF="000048.html">[WSJT-SVN] r363 - trunk
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#47">[ date ]</a>
              <a href="thread.html#47">[ thread ]</a>
              <a href="subject.html#47">[ subject ]</a>
              <a href="author.html#47">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/wsjt-svn">More information about the wsjt-svn
mailing list</a><br>
</body></html>
