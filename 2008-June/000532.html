<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [WSJT-SVN] r844 - trunk
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/wsjt-svn/2008-June/index.html" >
   <LINK REL="made" HREF="mailto:wsjt-svn%40lists.berlios.de?Subject=Re%3A%20%5BWSJT-SVN%5D%20r844%20-%20trunk&In-Reply-To=%3C200806061933.m56JXrPe003996%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000531.html">
   <LINK REL="Next"  HREF="000533.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[WSJT-SVN] r844 - trunk</H1>
    <B>va3db at BerliOS</B> 
    <A HREF="mailto:wsjt-svn%40lists.berlios.de?Subject=Re%3A%20%5BWSJT-SVN%5D%20r844%20-%20trunk&In-Reply-To=%3C200806061933.m56JXrPe003996%40sheep.berlios.de%3E"
       TITLE="[WSJT-SVN] r844 - trunk">va3db at mail.berlios.de
       </A><BR>
    <I>Fri Jun  6 21:33:53 CEST 2008</I>
    <P><UL>
        <LI>Previous message: <A HREF="000531.html">[WSJT-SVN] r843 - trunk
</A></li>
        <LI>Next message: <A HREF="000533.html">[WSJT-SVN] r845 - branches/wspr
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#532">[ date ]</a>
              <a href="thread.html#532">[ thread ]</a>
              <a href="subject.html#532">[ subject ]</a>
              <a href="author.html#532">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: va3db
Date: 2008-06-06 21:33:52 +0200 (Fri, 06 Jun 2008)
New Revision: 844

Modified:
   trunk/Makefile.in
   trunk/configure
   trunk/configure.ac
Log:
- Check for a portaudio version, if found it is v19 at the minimum
  v18 does not support a Pa_GetVersion
  Use this to try and find a working v19 portaudio.
  N.B. There will still be a need for the --with-portaudio-include-dir=&lt;path&gt;
  and --with-portaudio-lib-dir=&lt;path&gt; options to configure.



Modified: trunk/Makefile.in
===================================================================
--- trunk/Makefile.in	2008-06-06 16:04:48 UTC (rev 843)
+++ trunk/Makefile.in	2008-06-06 19:33:52 UTC (rev 844)
@@ -2,9 +2,6 @@
 CC ?= @CC@
 FFLAGS	= @FFLAGS@
 LDFLAGS	= @LDFLAGS@
-#
-# XXX N.B. this is non standard
-#
 LIBS	+= @LIBS@
 CPPFLAGS = @CPPFLAGS@
 CFLAGS	= @CFLAGS@

Modified: trunk/configure
===================================================================
--- trunk/configure	2008-06-06 16:04:48 UTC (rev 843)
+++ trunk/configure	2008-06-06 19:33:52 UTC (rev 844)
@@ -2,7 +2,7 @@
 # Guess values for system-dependent variables and create Makefiles.
 # Generated by GNU Autoconf 2.62 for wsjt 5.9.6.
 #
-# $Id: configure.ac 842 2008-06-05 22:54:22Z va3db $
+# $Id: configure.ac 843 2008-06-06 16:04:48Z va3db $
 #
 # Copyright (C) 1992, 1993, 1994, 1995, 1996, 1998, 1999, 2000, 2001,
 # 2002, 2003, 2004, 2005, 2006, 2007, 2008 Free Software Foundation, Inc.
@@ -1451,7 +1451,7 @@
 This configure script is free software; the Free Software Foundation
 gives unlimited permission to copy, distribute and modify it.
 
-$Id: configure.ac 842 2008-06-05 22:54:22Z va3db $
+$Id: configure.ac 843 2008-06-06 16:04:48Z va3db $
 _ACEOF
   exit
 fi
@@ -5166,148 +5166,6 @@
 
 fi
 
-{ $as_echo &quot;$as_me:$LINENO: checking for clock_gettime in -lrt&quot; &gt;&amp;5
-$as_echo_n &quot;checking for clock_gettime in -lrt... &quot; &gt;&amp;6; }
-if test &quot;${ac_cv_lib_rt_clock_gettime+set}&quot; = set; then
-  $as_echo_n &quot;(cached) &quot; &gt;&amp;6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS=&quot;-lrt  $LIBS&quot;
-cat &gt;conftest.$ac_ext &lt;&lt;_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h &gt;&gt;conftest.$ac_ext
-cat &gt;&gt;conftest.$ac_ext &lt;&lt;_ACEOF
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern &quot;C&quot;
-#endif
-char clock_gettime ();
-int
-main ()
-{
-return clock_gettime ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try=&quot;$ac_link&quot;
-case &quot;(($ac_try&quot; in
-  *\&quot;* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo=&quot;\&quot;\$as_me:$LINENO: $ac_try_echo\&quot;&quot;
-$as_echo &quot;$ac_try_echo&quot;) &gt;&amp;5
-  (eval &quot;$ac_link&quot;) 2&gt;conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 &gt;conftest.err
-  rm -f conftest.er1
-  cat conftest.err &gt;&amp;5
-  $as_echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); } &amp;&amp; {
-	 test -z &quot;$ac_c_werror_flag&quot; ||
-	 test ! -s conftest.err
-       } &amp;&amp; test -s conftest$ac_exeext &amp;&amp; {
-	 test &quot;$cross_compiling&quot; = yes ||
-	 $as_test_x conftest$ac_exeext
-       }; then
-  ac_cv_lib_rt_clock_gettime=yes
-else
-  $as_echo &quot;$as_me: failed program was:&quot; &gt;&amp;5
-sed 's/^/| /' conftest.$ac_ext &gt;&amp;5
-
-	ac_cv_lib_rt_clock_gettime=no
-fi
-
-rm -rf conftest.dSYM
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo &quot;$as_me:$LINENO: result: $ac_cv_lib_rt_clock_gettime&quot; &gt;&amp;5
-$as_echo &quot;$ac_cv_lib_rt_clock_gettime&quot; &gt;&amp;6; }
-if test $ac_cv_lib_rt_clock_gettime = yes; then
-  RTLIBS=&quot;-lrt&quot;
-else
-  RTLIBS=&quot;&quot;
-fi
-
-{ $as_echo &quot;$as_me:$LINENO: checking for snd_pcm_open in -lasound&quot; &gt;&amp;5
-$as_echo_n &quot;checking for snd_pcm_open in -lasound... &quot; &gt;&amp;6; }
-if test &quot;${ac_cv_lib_asound_snd_pcm_open+set}&quot; = set; then
-  $as_echo_n &quot;(cached) &quot; &gt;&amp;6
-else
-  ac_check_lib_save_LIBS=$LIBS
-LIBS=&quot;-lasound  $LIBS&quot;
-cat &gt;conftest.$ac_ext &lt;&lt;_ACEOF
-/* confdefs.h.  */
-_ACEOF
-cat confdefs.h &gt;&gt;conftest.$ac_ext
-cat &gt;&gt;conftest.$ac_ext &lt;&lt;_ACEOF
-/* end confdefs.h.  */
-
-/* Override any GCC internal prototype to avoid an error.
-   Use char because int might match the return type of a GCC
-   builtin and then its argument prototype would still apply.  */
-#ifdef __cplusplus
-extern &quot;C&quot;
-#endif
-char snd_pcm_open ();
-int
-main ()
-{
-return snd_pcm_open ();
-  ;
-  return 0;
-}
-_ACEOF
-rm -f conftest.$ac_objext conftest$ac_exeext
-if { (ac_try=&quot;$ac_link&quot;
-case &quot;(($ac_try&quot; in
-  *\&quot;* | *\`* | *\\*) ac_try_echo=\$ac_try;;
-  *) ac_try_echo=$ac_try;;
-esac
-eval ac_try_echo=&quot;\&quot;\$as_me:$LINENO: $ac_try_echo\&quot;&quot;
-$as_echo &quot;$ac_try_echo&quot;) &gt;&amp;5
-  (eval &quot;$ac_link&quot;) 2&gt;conftest.er1
-  ac_status=$?
-  grep -v '^ *+' conftest.er1 &gt;conftest.err
-  rm -f conftest.er1
-  cat conftest.err &gt;&amp;5
-  $as_echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
-  (exit $ac_status); } &amp;&amp; {
-	 test -z &quot;$ac_c_werror_flag&quot; ||
-	 test ! -s conftest.err
-       } &amp;&amp; test -s conftest$ac_exeext &amp;&amp; {
-	 test &quot;$cross_compiling&quot; = yes ||
-	 $as_test_x conftest$ac_exeext
-       }; then
-  ac_cv_lib_asound_snd_pcm_open=yes
-else
-  $as_echo &quot;$as_me: failed program was:&quot; &gt;&amp;5
-sed 's/^/| /' conftest.$ac_ext &gt;&amp;5
-
-	ac_cv_lib_asound_snd_pcm_open=no
-fi
-
-rm -rf conftest.dSYM
-rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
-      conftest$ac_exeext conftest.$ac_ext
-LIBS=$ac_check_lib_save_LIBS
-fi
-{ $as_echo &quot;$as_me:$LINENO: result: $ac_cv_lib_asound_snd_pcm_open&quot; &gt;&amp;5
-$as_echo &quot;$ac_cv_lib_asound_snd_pcm_open&quot; &gt;&amp;6; }
-if test $ac_cv_lib_asound_snd_pcm_open = yes; then
-  ASOUNDLIBS=&quot;-lasound&quot;
-else
-  ASOUNDLIBS=&quot;&quot;
-fi
-
 { $as_echo &quot;$as_me:$LINENO: checking for fftwf_mkplan in -lfftw3f&quot; &gt;&amp;5
 $as_echo_n &quot;checking for fftwf_mkplan in -lfftw3f... &quot; &gt;&amp;6; }
 if test &quot;${ac_cv_lib_fftw3f_fftwf_mkplan+set}&quot; = set; then
@@ -7472,8 +7330,8 @@
 ac_config_files=&quot;$ac_config_files Makefile&quot;
 
 
-portaudio_lib_dir=&quot;&quot;
-portaudio_include_dir=&quot;&quot;
+portaudio_lib_dir=&quot;/usr/lib&quot;
+portaudio_include_dir=&quot;/usr/include&quot;
 
 
 # Check whether --with-portaudio-include-dir was given.
@@ -7489,7 +7347,8 @@
 fi
 
 
-if test -e ${portaudio_lib_dir}/libportaudio.so -o -e ${portaudio_lib_dir}/libportaudio.a;then
+if test -e ${portaudio_lib_dir}/libportaudio.so \
+    -o -e ${portaudio_lib_dir}/libportaudio.a;then
 	HAS_PORTAUDIO_LIB=1
 fi
 if test -e ${portaudio_include_dir}/portaudio.h; then
@@ -7587,11 +7446,6 @@
 
 
 
-if test $HAS_PORTAUDIO -eq 0; then
-	{ { $as_echo &quot;$as_me:$LINENO: error: You need to install an usable portaudio v19; see README&quot; &gt;&amp;5
-$as_echo &quot;$as_me: error: You need to install an usable portaudio v19; see README&quot; &gt;&amp;2;}
-   { (exit 1); exit 1; }; }
-fi
 if test $HAS_FFTW3_H -eq 0; then
 	{ { $as_echo &quot;$as_me:$LINENO: error: You need to install the fftw3 libraries&quot; &gt;&amp;5
 $as_echo &quot;$as_me: error: You need to install the fftw3 libraries&quot; &gt;&amp;2;}
@@ -7604,7 +7458,6 @@
 fi
 
 
-
 if test $HAS_PORTAUDIO_H -eq 1; then
 	cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
 #define HAS_PORTAUDIO_H 1
@@ -7613,8 +7466,184 @@
 	LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
 	LIBS=&quot;${LIBS} -lportaudio&quot;
 	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
+	{ $as_echo &quot;$as_me:$LINENO: checking for Pa_GetVersion in -lportaudio&quot; &gt;&amp;5
+$as_echo_n &quot;checking for Pa_GetVersion in -lportaudio... &quot; &gt;&amp;6; }
+if test &quot;${ac_cv_lib_portaudio_Pa_GetVersion+set}&quot; = set; then
+  $as_echo_n &quot;(cached) &quot; &gt;&amp;6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS=&quot;-lportaudio  $LIBS&quot;
+cat &gt;conftest.$ac_ext &lt;&lt;_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h &gt;&gt;conftest.$ac_ext
+cat &gt;&gt;conftest.$ac_ext &lt;&lt;_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern &quot;C&quot;
+#endif
+char Pa_GetVersion ();
+int
+main ()
+{
+return Pa_GetVersion ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try=&quot;$ac_link&quot;
+case &quot;(($ac_try&quot; in
+  *\&quot;* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo=&quot;\&quot;\$as_me:$LINENO: $ac_try_echo\&quot;&quot;
+$as_echo &quot;$ac_try_echo&quot;) &gt;&amp;5
+  (eval &quot;$ac_link&quot;) 2&gt;conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 &gt;conftest.err
+  rm -f conftest.er1
+  cat conftest.err &gt;&amp;5
+  $as_echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
+  (exit $ac_status); } &amp;&amp; {
+	 test -z &quot;$ac_c_werror_flag&quot; ||
+	 test ! -s conftest.err
+       } &amp;&amp; test -s conftest$ac_exeext &amp;&amp; {
+	 test &quot;$cross_compiling&quot; = yes ||
+	 $as_test_x conftest$ac_exeext
+       }; then
+  ac_cv_lib_portaudio_Pa_GetVersion=yes
+else
+  $as_echo &quot;$as_me: failed program was:&quot; &gt;&amp;5
+sed 's/^/| /' conftest.$ac_ext &gt;&amp;5
+
+	ac_cv_lib_portaudio_Pa_GetVersion=no
 fi
 
+rm -rf conftest.dSYM
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ $as_echo &quot;$as_me:$LINENO: result: $ac_cv_lib_portaudio_Pa_GetVersion&quot; &gt;&amp;5
+$as_echo &quot;$ac_cv_lib_portaudio_Pa_GetVersion&quot; &gt;&amp;6; }
+if test $ac_cv_lib_portaudio_Pa_GetVersion = yes; then
+  \
+		HAS_PORTAUDIO_VERSION=1
+else
+  HAS_PORTAUDIO_VERSION=0
+fi
+
+	if test $HAS_PORTAUDIO_VERSION -eq 0; then
+		{ { $as_echo &quot;$as_me:$LINENO: error: This is likely portaudio v18; you need v19&quot; &gt;&amp;5
+$as_echo &quot;$as_me: error: This is likely portaudio v18; you need v19&quot; &gt;&amp;2;}
+   { (exit 1); exit 1; }; }
+	fi
+else
+	{ $as_echo &quot;$as_me:$LINENO: result: Trying FreeBSD paths&quot; &gt;&amp;5
+$as_echo &quot;Trying FreeBSD paths&quot; &gt;&amp;6; }
+	portaudio_lib_dir=&quot;/usr/local/lib/portaudio2&quot;
+	portaudio_include_dir=&quot;/usr/local/include/portaudio2&quot;
+	if test -e ${portaudio_lib_dir}/libportaudio.so -o -e \
+		${portaudio_lib_dir}/libportaudio.a;then
+		HAS_PORTAUDIO_LIB=1
+	fi
+	if test -e ${portaudio_include_dir}/portaudio.h; then
+		HAS_PORTAUDIO_H=1
+	fi
+	if test $HAS_PORTAUDIO_H -eq 1 -a $HAS_PORTAUDIO_LIB -eq 1; then
+		HAS_PORTAUDIO=1
+		cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
+#define HAS_PORTAUDIO_H 1
+_ACEOF
+
+		LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
+		LIBS=&quot;${LIBS} -lportaudio&quot;
+		CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
+		{ $as_echo &quot;$as_me:$LINENO: checking for Pa_GetVersion in -lportaudio&quot; &gt;&amp;5
+$as_echo_n &quot;checking for Pa_GetVersion in -lportaudio... &quot; &gt;&amp;6; }
+if test &quot;${ac_cv_lib_portaudio_Pa_GetVersion+set}&quot; = set; then
+  $as_echo_n &quot;(cached) &quot; &gt;&amp;6
+else
+  ac_check_lib_save_LIBS=$LIBS
+LIBS=&quot;-lportaudio  $LIBS&quot;
+cat &gt;conftest.$ac_ext &lt;&lt;_ACEOF
+/* confdefs.h.  */
+_ACEOF
+cat confdefs.h &gt;&gt;conftest.$ac_ext
+cat &gt;&gt;conftest.$ac_ext &lt;&lt;_ACEOF
+/* end confdefs.h.  */
+
+/* Override any GCC internal prototype to avoid an error.
+   Use char because int might match the return type of a GCC
+   builtin and then its argument prototype would still apply.  */
+#ifdef __cplusplus
+extern &quot;C&quot;
+#endif
+char Pa_GetVersion ();
+int
+main ()
+{
+return Pa_GetVersion ();
+  ;
+  return 0;
+}
+_ACEOF
+rm -f conftest.$ac_objext conftest$ac_exeext
+if { (ac_try=&quot;$ac_link&quot;
+case &quot;(($ac_try&quot; in
+  *\&quot;* | *\`* | *\\*) ac_try_echo=\$ac_try;;
+  *) ac_try_echo=$ac_try;;
+esac
+eval ac_try_echo=&quot;\&quot;\$as_me:$LINENO: $ac_try_echo\&quot;&quot;
+$as_echo &quot;$ac_try_echo&quot;) &gt;&amp;5
+  (eval &quot;$ac_link&quot;) 2&gt;conftest.er1
+  ac_status=$?
+  grep -v '^ *+' conftest.er1 &gt;conftest.err
+  rm -f conftest.er1
+  cat conftest.err &gt;&amp;5
+  $as_echo &quot;$as_me:$LINENO: \$? = $ac_status&quot; &gt;&amp;5
+  (exit $ac_status); } &amp;&amp; {
+	 test -z &quot;$ac_c_werror_flag&quot; ||
+	 test ! -s conftest.err
+       } &amp;&amp; test -s conftest$ac_exeext &amp;&amp; {
+	 test &quot;$cross_compiling&quot; = yes ||
+	 $as_test_x conftest$ac_exeext
+       }; then
+  ac_cv_lib_portaudio_Pa_GetVersion=yes
+else
+  $as_echo &quot;$as_me: failed program was:&quot; &gt;&amp;5
+sed 's/^/| /' conftest.$ac_ext &gt;&amp;5
+
+	ac_cv_lib_portaudio_Pa_GetVersion=no
+fi
+
+rm -rf conftest.dSYM
+rm -f core conftest.err conftest.$ac_objext conftest_ipa8_conftest.oo \
+      conftest$ac_exeext conftest.$ac_ext
+LIBS=$ac_check_lib_save_LIBS
+fi
+{ $as_echo &quot;$as_me:$LINENO: result: $ac_cv_lib_portaudio_Pa_GetVersion&quot; &gt;&amp;5
+$as_echo &quot;$ac_cv_lib_portaudio_Pa_GetVersion&quot; &gt;&amp;6; }
+if test $ac_cv_lib_portaudio_Pa_GetVersion = yes; then
+  \
+			HAS_PORTAUDIO_VERSION=1
+else
+  HAS_PORTAUDIO_VERSION=0
+fi
+
+		if test $HAS_PORTAUDIO_VERSION -eq 0; then
+			{ { $as_echo &quot;$as_me:$LINENO: error: This is likely portaudio v18; you need v19&quot; &gt;&amp;5
+$as_echo &quot;$as_me: error: This is likely portaudio v18; you need v19&quot; &gt;&amp;2;}
+   { (exit 1); exit 1; }; }
+		fi
+	fi
+fi
+
 if test $HAS_SAMPLERATE_H -eq 1; then
         cat &gt;&gt;confdefs.h &lt;&lt;\_ACEOF
 #define HAS_SAMPLERATE_H 1

Modified: trunk/configure.ac
===================================================================
--- trunk/configure.ac	2008-06-06 16:04:48 UTC (rev 843)
+++ trunk/configure.ac	2008-06-06 19:33:52 UTC (rev 844)
@@ -128,8 +128,6 @@
 	AC_DEFINE(STRING_WITH_STRINGS, 1, [Define to 1 if string.h may be included along with strings.h])
 fi
 
-AC_CHECK_LIB(rt, clock_gettime, [RTLIBS=&quot;-lrt&quot;], [RTLIBS=&quot;&quot;])
-AC_CHECK_LIB(asound, snd_pcm_open, [ASOUNDLIBS=&quot;-lasound&quot;], [ASOUNDLIBS=&quot;&quot;])
 AC_CHECK_LIB(fftw3f, fftwf_mkplan, [FFTW3LIBS=&quot;-lfftw3f&quot;], [FFTW3LIBS=&quot;&quot;])
 
 AC_CHECK_SIZEOF(int64_t)
@@ -210,8 +208,8 @@
 )
 
 dnl =========================================
-portaudio_lib_dir=&quot;&quot;
-portaudio_include_dir=&quot;&quot;
+portaudio_lib_dir=&quot;/usr/lib&quot;
+portaudio_include_dir=&quot;/usr/include&quot;
 
 AC_ARG_WITH([portaudio-include-dir],
 AC_HELP_STRING([--with-portaudio-include-dir=&lt;path&gt;],
@@ -225,7 +223,8 @@
 
 dnl make sure portaudio dirs are valid
 dnl ==================================
-if test -e ${portaudio_lib_dir}/libportaudio.so -o -e ${portaudio_lib_dir}/libportaudio.a;then
+if test -e ${portaudio_lib_dir}/libportaudio.so \
+    -o -e ${portaudio_lib_dir}/libportaudio.a;then
 	HAS_PORTAUDIO_LIB=1
 fi
 if test -e ${portaudio_include_dir}/portaudio.h; then
@@ -309,9 +308,6 @@
 
 dnl sanity tests.
 
-if test $HAS_PORTAUDIO -eq 0; then
-	AC_MSG_ERROR([You need to install an usable portaudio v19; see README])
-fi
 if test $HAS_FFTW3_H -eq 0; then
 	AC_MSG_ERROR([You need to install the fftw3 libraries])
 fi
@@ -320,7 +316,6 @@
 fi
 
 dnl =====================
-
 dnl set conf flags
 dnl ==============
 
@@ -329,6 +324,37 @@
 	LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
 	LIBS=&quot;${LIBS} -lportaudio&quot;
 	CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
+	AC_CHECK_LIB(portaudio, Pa_GetVersion, \
+		[HAS_PORTAUDIO_VERSION=1], [HAS_PORTAUDIO_VERSION=0])
+	if test $HAS_PORTAUDIO_VERSION -eq 0; then
+		AC_MSG_ERROR([This is likely portaudio v18; you need v19])
+	fi
+else
+	AC_MSG_RESULT([Trying FreeBSD paths])
+	portaudio_lib_dir=&quot;/usr/local/lib/portaudio2&quot;
+	portaudio_include_dir=&quot;/usr/local/include/portaudio2&quot;
+dnl
+dnl Try again to make sure portaudio dirs are valid
+dnl
+	if test -e ${portaudio_lib_dir}/libportaudio.so -o -e \
+		${portaudio_lib_dir}/libportaudio.a;then
+		HAS_PORTAUDIO_LIB=1
+	fi
+	if test -e ${portaudio_include_dir}/portaudio.h; then
+		HAS_PORTAUDIO_H=1
+	fi
+	if test $HAS_PORTAUDIO_H -eq 1 -a $HAS_PORTAUDIO_LIB -eq 1; then
+		HAS_PORTAUDIO=1
+		AC_DEFINE(HAS_PORTAUDIO_H, 1, )
+		LDFLAGS=&quot;-L${portaudio_lib_dir} ${LDFLAGS}&quot;
+		LIBS=&quot;${LIBS} -lportaudio&quot;
+		CPPFLAGS=&quot;-I${portaudio_include_dir} ${CPPFLAGS}&quot;
+		AC_CHECK_LIB(portaudio, Pa_GetVersion, \
+			[HAS_PORTAUDIO_VERSION=1], [HAS_PORTAUDIO_VERSION=0])
+		if test $HAS_PORTAUDIO_VERSION -eq 0; then
+			AC_MSG_ERROR([This is likely portaudio v18; you need v19])
+		fi
+	fi
 fi
 
 if test $HAS_SAMPLERATE_H -eq 1; then


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000531.html">[WSJT-SVN] r843 - trunk
</A></li>
	<LI>Next message: <A HREF="000533.html">[WSJT-SVN] r845 - branches/wspr
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#532">[ date ]</a>
              <a href="thread.html#532">[ thread ]</a>
              <a href="subject.html#532">[ subject ]</a>
              <a href="author.html#532">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/wsjt-svn">More information about the wsjt-svn
mailing list</a><br>
</body></html>
